{% load staticfiles %}
<!DOCTYPE html>
<html>
<head>
<link rel="icon" href="{% static 'img/bot.png' %}" type="image/gif" sizes="16x16">
     <link rel="stylesheet" href="{% static 'css/Style.css' %}"/>
<title>iChat</title>
<script src="{% static 'js/jquery.js' %}"></script>

<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="{% static 'js/js.cookie.js' %}"></script>
    <script src="{% static 'js/bootstrap.js' %}"></script>
    

<script type="text/javascript">
var currentTime = time();
 var $input = $('.chatInput');
 var chatterbotUrl = '{% url "chatterbot:chatterbot" %}';
      var csrftoken = Cookies.get('csrftoken');

      function csrfSafeMethod(method) {
        // these HTTP methods do not require CSRF protection
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
      }

      $.ajaxSetup({
        beforeSend: function(xhr, settings) {
          if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
          }
        }
      });
<!-- writing a function to create input row when user submit its input-->
function createRowHuman(text) {
        var span = "<span class=\"humanMessage\" >"+ text +"<p class=\"showTime\">"+currentTime+"</span>";
			$("#chatArea").append(span);
			$("#chatInput").val("");
			$("#chatArea").animate({ scrollTop: $("#chatArea").prop('scrollHeight')}, 1000);
			//set a variable as isResponseRecieved= 0 and set the message that user chatbot is typing
			$('#chatInput').attr("placeholder","iChat is Typing...");
      }
function createRowBot(text) {
//set a variable as isResponseRecieved= 0 and empty the message that user chatbot is typing
       var span = "<span class=\"botMessage\" >"+ text +"<p class=\"showTime\">"+currentTime+"</span>";
		$("#chatArea").append(span);
		$("#chatInput").val("");
		$("#chatArea").animate({ scrollTop: $("#chatArea").prop('scrollHeight')}, 1000);
		$('#chatInput').attr("placeholder","Ask me anything...");

     }


function submitInput() {
        var inputData ={
        'text': $(".chatInput").val()
        };
        // Display the user's input on the web page
        if(inputData.text!="")
        {
        createRowHuman(inputData.text);


       var $submit = $.ajax({
         type: 'POST',
         url: chatterbotUrl,
         data: JSON.stringify(inputData),
         contentType: 'application/json'
       });


           $submit.done(function(statement) {
            createRowBot(statement.text);
       });
       }

        $submit.fail(function() {
          // TODO: Handle errors
        });
      }


$(document).ready(function() {

$("#chatBox").hide();
var reply = "<span class=\"botMessage\" >"+"Hi! My name is iChat and I am a Chatbot. I can help you with your work related queries. Please type in your question in the space provided.<p class=\"showTime\">"+currentTime+"</p></span></br></br></br>";


	$("#chatArea").append(reply);


	$("#chatBox").hide();
	$("#activateiChat").click(function(){
        $("#activateiChat").hide();
		$("#chatBox").show();
    });
	$("#minimizeButton").click(function(){
        $("#chatBox").hide();
		$("#activateiChat").show();
    });

});

function hideChatBox(){
	$("#chatBox").hide();
	$("#activateiChat").show();
}

function sayThanks(){
	var reply = "<span class=\"botMessage\" >"+"Thank you!"+"</span>";
	$("#chatArea").append(reply);
}
function saySorry(){
	var reply = "<span class=\"botMessage\" >"+"Okay, I shall try to serve you better next time. Sorry for the inconvenience!"+"</span>";
	$("#chatArea").append(reply);
}

function time(){
	var date = new Date();
	var hours = date.getHours();
	var minutes = date.getMinutes();
	var ampm = hours >= 12 ? 'PM' : 'AM';
	hours = hours % 12;
	hours = hours ? hours : 12; // the hour '0' should be '12'
	minutes = minutes < 10 ? '0'+minutes : minutes;
	var strTime = hours + ':' + minutes + ' ' + ampm;
	return strTime;
}
</script>
</head>
<body >



<div class="container-fluid">
<div class="mainContainer">
<div class="headingmain">
<img src="{% static 'img/25634.png' %}"/><span>Helpdesk Portal</span>
</div>
    <div class="row boxesmain">
        <div class="col-md-3 col-xl-3">
            <div class="card bg-c-blue order-card">
                <div class="card-block">
				<h2 class="text-left"><i class="fa fa-key" aria-hidden="true"></i></h2>
                    <h4 class="m-b-20"><a href="#">Access Management</a></h4>
                    
                    
                </div>
            </div>
        </div>
        
        <div class="col-md-3 col-xl-3">
            <div class="card bg-c-green order-card">
                <div class="card-block">
				<h2 class="text-left"><i class="fa fa-lightbulb-o" aria-hidden="true"></i></h2>
                    <h4 class="m-b-20"><a href="#">Knowledge Management</a></h4>
                    
                    
                </div>
            </div>
        </div>
        
        <div class="col-md-3 col-xl-3">
            <div class="card bg-c-yellow order-card">
                <div class="card-block">
                   
                    <h2 class="text-left"><i class="fa fa-eye" aria-hidden="true"></i></h2>
					 <h4 class="m-b-20"><a href="#">Incident Monitoring</a></h4>
                    
                </div>
            </div>
        </div>
        
        <div class="col-md-3 col-xl-3">
            <div class="card bg-c-pink order-card">
                <div class="card-block">
				<h2 class="text-left"><i class="fa fa-cogs" aria-hidden="true"></i></h2>
                    <h4 class="m-b-20"><a href="#">Job Run</a></h4>
                    
                    
                </div>
            </div>
        </div>
	</div>
</div>
<button id="activateiChat" > <img src="{% static 'img/bot.png' %}" /> </button>
<div id="chatBox">
<div id="header"><span id="botName">iChat  <img src="{% static 'img/greenDot.png' %}" alt="available" /></span><button id="minimizeButton" ><img id="minimize" src="{% static 'img/minimize.png' %}" alt="minimize"/></button></div>
<div id="body">

<div id="chatArea"> 

</div>


<input type="text" id="chatInput" class="chatInput" placeholder="Ask me anything..." onkeypress="if (event.keyCode == 13)
                        document.getElementById('sendButton').click()" /><button id="sendButton" onclick="submitInput();"> <img src="{% static 'img/sendAgain.png' %}" /> </button>
</div>
<div id="footer">Was this helpful? &nbsp;&nbsp;<a href="#" style="text-decoration:none;color:#fff;" onclick="sayThanks();">Yes</a> | <a href="#" style="text-decoration:none;color:#fff;" onclick="saySorry();">No</a></div>
</div>
</div>
</body>
</html>